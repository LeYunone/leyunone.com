---
date: 2023-11-22
title: 对应用\用户习惯而言的操作记录业务
category: 
  - 业务
tag:
  - 业务
---
# 方法操作日志

`操作`，这一简单两字，对于一款应用而言，在各个角度上看他是存有歧义的：

- 对于产品经理来说，操作是用户使用产品留下的 `习惯` 的动作
- 对于用户来说，操作是我建立某个可见性 `订单` 的动作
- 对于前端开发来说，操作是用户点击每一个按钮、文字、跳转...等等组件的动作
- 对于后端开发来说，操作是用户在数据库操作所留下的记录

那么我们该如何记录这些操作？

记录这些操作又有什么用？

本篇会以后端程序员的视角来看待 用户操作在应用中的定义。



## 如何记录操作

对于JAVA程序员来说，日志这两个字一定熟悉的不能在熟悉的名词

在Log4j的应用中，仅仅是一个日志打印，就可以追踪很多用户的操作行为。

但是此日志并非彼之日志，操作日志并非开发们平时调试程序所留下 调试日志点；操作更关注的是用户在什么时候做了什么，得到了什么结果这么一段链路。

那么记录操作重点在于理解什么才是用户的操作，在上面有说，从后端的角度上看， `操作是用户在数据库操作所留下的记录` ；

因为只有对数据进行编辑或查询，操作才算有效，况且记录操作的目的只有两种：

1. 记录用户使用习惯，统计功能高频点
2. 管理类系统进行操作记录

不管哪一种，都是会在数据库中留下痕迹。因此如何记录操作，则是对指定的接口\方法的出入参作定制化的日志记录。

看到这，不知你的脑子是否立马会蹦出一个词：`AOP`

涉及到了 `日志` 、`监听` 当然少不了设计中的AOP增强方法的思路

因此不管使用Cglib还是JDK，都可以实现监听指定接口\方法的记录动作，那么难点就在于定制化记录问题了。

比方说：用户创建订单，什么时候创建，名为什么的订单，订单的核心内容是什么

用户删除消息，什么时候删除，删除的消息是什么

.......

每个接口\方法的入参都不相同，那么如何做到定制化的思路呢？

可以参考`自定义注解` + `策略模式` 

见下述：

**自定义注解**

```java
public @interface OpertionLog{
    
    //操作模块
    OpertionModel model();
}
```

**定制化枚举**

```java
public Enum OpertionModel{
    
    USER()
    
    private Class<?> handClass;
    
}
```







## 有什么用

简单明说，用处：

- 便于进行数据追溯
- 便于开发者日志调试
- 便于统计功能的适用情况
- ....

在这个数据流

